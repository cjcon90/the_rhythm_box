{% extends 'store/base.html' %}

{% load static %}
{% load humanize %}
{% load cart_tags %}
{% load store_tags %}
{% load widget_tweaks %}

{% block title %}Checkout{% endblock title %}



{% block content %} 
    <h2 class="section__heading upper bold">Thank You</h2>
    <div class="order-confirmation-text regular t6">
        <p>Your order has been completed!</p>
        <p>Your order number is<br><strong>{{ order.order_number }}</strong></p>
        <p>A confirmation email has been sent to<br><strong>{{ order.email }}</strong></p>
        <p class="checkout-form__heading order-confirmation-text--info t3 light">Your order information is below</p>
    </div>
    <div class="checkout order-confirmation-summary">
        <div class="checkout-summary">
            <h3 class="checkout-summary__heading t4 light">Order Items ({{ product_count }})</h3>
            <table class="checkout-summary__table">
                <tr class="checkout-summary__table__headings bold t7">
                    <th class="checkout-summary__table__headings--image"></th>
                    <th class="checkout-summary__table__headings--item">Item</th>
                    <th class="checkout-summary__table__headings--quantity">Quantity</th>
                    <th class="checkout-summary__table__headings--subtotal">Price</th>
                </tr>
                {% for item in cart_items %}
                <tr class="checkout-summary__table__data">
                    <td class="checkout-summary__table__data--image"><img src="{{ item.product.image.url }}" alt=""></td>
                    <td class="checkout-summary__table__data--title">{{ item.product.title }}</td>
                    <td class="checkout-summary__table__data--quantity">{{ item.quantity }}</td>
                    <td class="checkout-summary__table__data--price">€{{ item.price|floatformat:"-2"|intcomma }}</td>
                </tr>
                {% endfor %}
            </table>
            <div class="checkout-summary-totals">
                <div class="checkout-summary-totals--order">
                    <p class="checkout-summary-totals__label regular t7">Order Total:</p>
                    <p class="checkout-summary-totals__data regular t7">€{{ total|floatformat:"-2"|intcomma }}</p>
                </div>
                <div class="checkout-summary-totals--delivery">
                    <p class="checkout-summary-totals__label regular t7">Delivery:</p>
                    <p class="checkout-summary-totals__data regular t7">€{{ delivery|floatformat:"-2"|intcomma }}</p>
                </div>
                <div class="checkout-summary-totals--grand">
                    <p class="checkout-summary-totals__label bold t6">Grand Total:</p>
                    <p class="checkout-summary-totals__data bold t6">€{{ grand_total|floatformat:"-2"|intcomma }}</p>
                </div>

            </div>
        </div>
    </div>
    </div>
{% endblock content %}

{% block js %}
<script type="module" src="{% static 'scripts/quantitySelect.js' %}"></script>
    {{ block.super }}
    {{ stripe_public_key|json_script:"id_stripe_public_key" }}
    {{ client_secret|json_script:"id_client_secret" }}
<script src="{% static 'scripts/stripeElements.js' %}"></script>
{% endblock js %}